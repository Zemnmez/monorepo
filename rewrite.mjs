import fs from 'node:fs/promises';
const rewrites = {
    "cc/inkscape/run": "cc/inkscape/run.js",
    "ci/postsubmit": "ci/postsubmit.js",
    "ci/presubmit": "ci/presubmit.js",
    "ci/rollback": "ci/rollback.js",
    "ci/submit": "ci/submit.js",
    "js/api-extractor/config_gen/main": "js/api-extractor/config_gen/main.js",
    "js/api-extractor/testing/import": "js/api-extractor/testing/import/index.js",
    "js/api-extractor/testing/import/something": "js/api-extractor/testing/import/something.js",
    "js/api-extractor/testing/simple/something": "js/api-extractor/testing/simple/something.js",
    "js/jest/jest_reporter": "js/jest/jest_reporter.js",
    "js/npm/package_json/gen_pkgjson": "js/npm/package_json/gen_pkgjson.js",
    "js/testing/node_version/node_version_test": "js/testing/node_version/node_version_test.js",
    "js/testing/simple_binary_import/lib": "js/testing/simple_binary_import/lib.js",
    "js/testing/simple_binary_import/main": "js/testing/simple_binary_import/main.js",
    "mdx/article/treeList": "mdx/article/treeList.js",
    "mdx/layouts/sink": "mdx/layouts/sink.js",
    "mdx/layouts/transition": "mdx/layouts/transition.js",
    "project/cultist/action": "project/cultist/action.js",
    "project/cultist/action_test": "project/cultist/action_test.js",
    "project/cultist/aspects": "project/cultist/aspects.js",
    "project/cultist/element": "project/cultist/element.js",
    "project/cultist/element_test": "project/cultist/element_test.js",
    "project/cultist/example/savestate": "project/cultist/example/savestate.js",
    "project/cultist/gen/collate_game_core": "project/cultist/gen/collate_game_core.js",
    "project/cultist/history": "project/cultist/history.js",
    "project/cultist": "project/cultist/index.js",
    "project/cultist/multiplayer": "project/cultist/multiplayer/index.js",
    "project/cultist/multiplayer/pages": "project/cultist/multiplayer/pages/index.js",
    "project/cultist/react": "project/cultist/react/index.js",
    "project/cultist/react/table": "project/cultist/react/table.js",
    "project/cultist/recipe": "project/cultist/recipe.js",
    "project/cultist/save": "project/cultist/save.js",
    "project/cultist/save_test": "project/cultist/save_test.js",
    "project/cultist/slots": "project/cultist/slots.js",
    "project/cultist/solve/main": "project/cultist/solve/main.js",
    "project/cultist/state/deserialize": "project/cultist/state/deserialize.js",
    "project/cultist/state": "project/cultist/state/index.js",
    "project/cultist/state/op": "project/cultist/state/op.js",
    "project/cultist/state/serialize": "project/cultist/state/serialize.js",
    "project/cultist/state/state": "project/cultist/state/state.js",
    "project/cultist/state/state_test": "project/cultist/state/state_test.js",
    "project/cultist/types": "project/cultist/types.js",
    "project/cultist/verb": "project/cultist/verb.js",
    "project/linear2/features/elements/Arrow/arrow": "project/linear2/features/elements/Arrow/arrow.js",
    "project/linear2/features/elements/Arrow": "project/linear2/features/elements/Arrow/index.js",
    "project/linear2/features/elements/CodeBlock": "project/linear2/features/elements/CodeBlock/index.js",
    "project/linear2/features/elements/TreeList": "project/linear2/features/elements/TreeList/index.js",
    "project/linear2/features/elements/date": "project/linear2/features/elements/date.js",
    "project/linear2/features/elements/elements": "project/linear2/features/elements/elements.js",
    "project/linear2/features/elements/extraElements": "project/linear2/features/elements/extraElements.js",
    "project/linear2/features/elements/extractText": "project/linear2/features/elements/extractText.js",
    "project/linear2/features/elements/fancy/counters": "project/linear2/features/elements/fancy/counters.js",
    "project/linear2/features/elements/fancy": "project/linear2/features/elements/fancy/index.js",
    "project/linear2/features/elements/headingsAndSections/fancy": "project/linear2/features/elements/headingsAndSections/fancy.js",
    "project/linear2/features/elements/headingsAndSections/headingsAndSections": "project/linear2/features/elements/headingsAndSections/headingsAndSections.js",
    "project/linear2/features/elements/headingsAndSections": "project/linear2/features/elements/headingsAndSections/index.js",
    "project/linear2/features/elements/headingsAndSections/outlineState": "project/linear2/features/elements/headingsAndSections/outlineState.js",
    "project/linear2/features/elements": "project/linear2/features/elements/index.js",
    "project/linear2/features/elements/style": "project/linear2/features/elements/style.js",
    "project/linear2/features/elements/text": "project/linear2/features/elements/text.js",
    "project/linear2/features/elements/timeline/components": "project/linear2/features/elements/timeline/components.js",
    "project/linear2/features/elements/timeline": "project/linear2/features/elements/timeline/index.js",
    "project/linear2/features/elements/util.test": "project/linear2/features/elements/util.test.js",
    "project/linear2/features/elements/util": "project/linear2/features/elements/util.js",
    "project/linear2/features/elements/void": "project/linear2/features/elements/void.js",
    "project/linear2/features/layout/base": "project/linear2/features/layout/base.js",
    "project/zemn.me/bio/bio": "project/zemn.me/bio/bio.js",
    "project/zemn.me/bio": "project/zemn.me/bio/index.js",
    "project/zemn.me/bio/sort_tool/sort_tool": "project/zemn.me/bio/sort_tool/sort_tool.js",
    "project/zemn.me/elements/DarkModeSwitcher/DarkModeSwitcher": "project/zemn.me/elements/DarkModeSwitcher/DarkModeSwitcher.js",
    "project/zemn.me/elements/DarkModeSwitcher": "project/zemn.me/elements/DarkModeSwitcher/index.js",
    "project/zemn.me/elements/NavBar/NavBar": "project/zemn.me/elements/NavBar/NavBar.js",
    "project/zemn.me/elements/NavBar": "project/zemn.me/elements/NavBar/index.js",
    "project/zemn.me/elements/SliderCheckbox/SliderCheckbox": "project/zemn.me/elements/SliderCheckbox/SliderCheckbox.js",
    "project/zemn.me/elements/SliderCheckbox": "project/zemn.me/elements/SliderCheckbox/index.js",
    "project/zemn.me/elements/TimeEye/TimeEye": "project/zemn.me/elements/TimeEye/TimeEye.js",
    "project/zemn.me/elements/TimeEye": "project/zemn.me/elements/TimeEye/index.js",
    "project/zemn.me/elements/TitlePage/TitlePage": "project/zemn.me/elements/TitlePage/TitlePage.js",
    "project/zemn.me/elements/TitlePage": "project/zemn.me/elements/TitlePage/index.js",
    "project/zemn.me/elements/ZemnmezLogo/ZemnmezLogo": "project/zemn.me/elements/ZemnmezLogo/ZemnmezLogo.js",
    "project/zemn.me/elements/ZemnmezLogo": "project/zemn.me/elements/ZemnmezLogo/index.js",
    "project/zemn.me/hooks/useClickedOff": "project/zemn.me/hooks/useClickedOff.js",
    "project/zemn.me/hooks/useHoverMenu": "project/zemn.me/hooks/useHoverMenu.js",
    "project/zemn.me/hooks/useMouseInside": "project/zemn.me/hooks/useMouseInside.js",
    "project/zemn.me/next/assets/kenwood": "project/zemn.me/next/assets/kenwood/index.js",
    "project/zemn.me/next/assets/kenwood/kenwood": "project/zemn.me/next/assets/kenwood/kenwood.js",
    "project/zemn.me/next/components/timeline": "project/zemn.me/next/components/timeline/index.js",
    "project/zemn.me/next/components/timeline/timeline": "project/zemn.me/next/components/timeline/timeline.js",
    "project/zemn.me/next/pages/_app": "project/zemn.me/next/pages/_app.js",
    "project/zemn.me/next/pages/_document": "project/zemn.me/next/pages/_document.js",
    "project/zemn.me/next/pages": "project/zemn.me/next/pages/index.js",
    "project/zemn.me/pages/art": "project/zemn.me/pages/art/index.js",
    "project/zemn.me/pages/art/logo": "project/zemn.me/pages/art/logo.js",
    "project/zemn.me/pages": "project/zemn.me/pages/index.js",
    "project/zemn.me/pages/pages": "project/zemn.me/pages/pages.js",
    "testing/typescript_basic_test": "testing/typescript_basic_test.js",
    "ts/cmd/svgshot": "ts/cmd/svgshot/index.js",
    "ts/cmd/svgshot/lib": "ts/cmd/svgshot/lib.js",
    "ts/cmd/svgshot/run": "ts/cmd/svgshot/run.js",
    "ts/cmd/svgshot/svgshot_test": "ts/cmd/svgshot/svgshot_test.js",
    "ts/cmd/svgshot/testing/do_not_depend_on_typescript_test": "ts/cmd/svgshot/testing/do_not_depend_on_typescript_test.js",
    "ts/do-sync/doSync": "ts/do-sync/doSync.js",
    "ts/do-sync": "ts/do-sync/index.js",
    "ts/do-sync/testing/doSync_test": "ts/do-sync/testing/doSync_test.js",
    "ts/errors": "ts/errors.js",
    "ts/force_buffer_whole_video/force_buffer_whole_video": "ts/force_buffer_whole_video/force_buffer_whole_video.js",
    "ts/fs/fs_test": "ts/fs/fs_test.js",
    "ts/fs": "ts/fs/index.js",
    "ts/guard": "ts/guard.js",
    "ts/guards": "ts/guards.js",
    "ts/iter/dict": "ts/iter/dict.js",
    "ts/iter": "ts/iter/index.js",
    "ts/iter/iter_test": "ts/iter/iter_test.js",
    "ts/jest/jest.browser.config": "ts/jest/jest.browser.config.js",
    "ts/jest/jest.node.config": "ts/jest/jest.node.config.js",
    "ts/jest/jest.setup": "ts/jest/jest.setup.js",
    "ts/knowitwhenyouseeit": "ts/knowitwhenyouseeit/index.js",
    "ts/knowitwhenyouseeit/main_test": "ts/knowitwhenyouseeit/main_test.js",
    "ts/log": "ts/log/index.js",
    "ts/log/log": "ts/log/log.js",
    "ts/log/log_test": "ts/log/log_test.js",
    "ts/math/bitfield": "ts/math/bitfield.js",
    "ts/math/camera": "ts/math/camera.js",
    "ts/math/camera_test": "ts/math/camera_test.js",
    "ts/math/canvas/braille/braille": "ts/math/canvas/braille/braille.js",
    "ts/math/canvas/braille/braille_test": "ts/math/canvas/braille/braille_test.js",
    "ts/math/canvas/element": "ts/math/canvas/element.js",
    "ts/math/canvas": "ts/math/canvas/index.js",
    "ts/math/cartesian": "ts/math/cartesian.js",
    "ts/math/conv": "ts/math/conv.js",
    "ts/math/conv_test": "ts/math/conv_test.js",
    "ts/math/euler_angle": "ts/math/euler_angle.js",
    "ts/math/homog": "ts/math/homog.js",
    "ts/math/math_test": "ts/math/math_test.js",
    "ts/math/matrix": "ts/math/matrix.js",
    "ts/math/quaternion": "ts/math/quaternion.js",
    "ts/math/quaternion_test": "ts/math/quaternion_test.js",
    "ts/math/scale": "ts/math/scale/index.js",
    "ts/math/scale/scale_test": "ts/math/scale/scale_test.js",
    "ts/math/shape": "ts/math/shape/index.js",
    "ts/math/shape/shape_test": "ts/math/shape/shape_test.js",
    "ts/math/tuple": "ts/math/tuple.js",
    "ts/math/vec": "ts/math/vec.js",
    "ts/next.js": "ts/next.js/index.js",
    "ts/next.js/next.config": "ts/next.js/next.config.js",
    "ts/next.js/testing/example/launch_server_test": "ts/next.js/testing/example/launch_server_test.js",
    "ts/next.js/testing/example/pages": "ts/next.js/testing/example/pages/index.js",
    "ts/pulumi/deploy_to_staging": "ts/pulumi/deploy_to_staging.js",
    "ts/pulumi": "ts/pulumi/index.js",
    "ts/pulumi/lib/certificate": "ts/pulumi/lib/certificate.js",
    "ts/pulumi/lib/file": "ts/pulumi/lib/file.js",
    "ts/pulumi/lib": "ts/pulumi/lib/index.js",
    "ts/pulumi/lib/path": "ts/pulumi/lib/path.js",
    "ts/pulumi/lib/website": "ts/pulumi/lib/website.js",
    "ts/pulumi/pleaseintroducemetoyour.dog": "ts/pulumi/pleaseintroducemetoyour.dog/index.js",
    "ts/pulumi/pleaseintroducemetoyour.dog/pages/_app": "ts/pulumi/pleaseintroducemetoyour.dog/pages/_app.js",
    "ts/pulumi/pleaseintroducemetoyour.dog/pages": "ts/pulumi/pleaseintroducemetoyour.dog/pages/index.js",
    "ts/pulumi/preview": "ts/pulumi/preview.js",
    "ts/pulumi/pulumi_test": "ts/pulumi/pulumi_test.js",
    "ts/pulumi/setMocks": "ts/pulumi/setMocks.js",
    "ts/pulumi/shadwell.im": "ts/pulumi/shadwell.im/index.js",
    "ts/pulumi/stack": "ts/pulumi/stack.js",
    "ts/pulumi/zemn.me/availability/pages/_app": "ts/pulumi/zemn.me/availability/pages/_app.js",
    "ts/pulumi/zemn.me/availability/pages": "ts/pulumi/zemn.me/availability/pages/index.js",
    "ts/pulumi/zemn.me": "ts/pulumi/zemn.me/index.js",
    "ts/react/article/blurb/blurb_test": "ts/react/article/blurb/blurb_test.js",
    "ts/react/article/blurb": "ts/react/article/blurb/index.js",
    "ts/react/article": "ts/react/article/index.js",
    "ts/react/element": "ts/react/element/index.js",
    "ts/react/element/link": "ts/react/element/link/index.js",
    "ts/react/element/link/link_test": "ts/react/element/link/link_test.js",
    "ts/react/element/loading": "ts/react/element/loading/index.js",
    "ts/react/element/loading/loading": "ts/react/element/loading/loading.js",
    "ts/react/lang": "ts/react/lang/index.js",
    "ts/svg": "ts/svg/index.js",
    "ts/svg/scale": "ts/svg/scale.js",
    "ts/testing/import_test/a": "ts/testing/import_test/a.js",
    "ts/testing/import_test/b": "ts/testing/import_test/b.js",
    "ts/testing/import_test/import_test": "ts/testing/import_test/import_test.js",
    "ts/time/date": "ts/time/date.js",
    "ts/time/date_test": "ts/time/date_test.js",
    "ts/time": "ts/time/index.js",
    "ts/tree": "ts/tree.js",
    "ts/url": "ts/url/index.js",
    "ts/url/url_test": "ts/url/url_test.js",
    "ts/util": "ts/util.js"
};

console.log(process.argv);

await Promise.all(process.argv.slice(2).map(f => fs.open(f).then(f => f.readFile())
    .then(file => {
	file = file.toString();
    for (const [from, to] of Object.entries(rewrites)) {
        file = file.replace(`"${from}"`, `'monorepo/${to}'`);
        file = file.replace(`'${from}'`, `'monorepo/${to}'`);
    }

	if (file.length === "") throw new Error("What the fuck?");
    return fs.writeFile(f, file);
})));
