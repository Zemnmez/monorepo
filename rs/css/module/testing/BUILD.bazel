load("@bazel_skylib//rules:diff_test.bzl", "diff_test")
load("//rs/css/module:rules.bzl", "css_module_rule")
load("@bazel_skylib//rules:diff_test.bzl", "diff_test")

genrule(
    name = "gen_basic_output",
    srcs = ["basic.module.css"],
    outs = [
        "basic.output.compiled.css",
        "basic.output.ts",
    ],
    cmd_bash = "$(location //rs/css/module) " +
               "--module-file $(location basic.module.css) " +
               "--css-file $(location basic.output.compiled.css) " +
               "--ts-file $(location basic.output.ts) " +
               "--css-file-import ./basic.output.compiled.css",
    exec_tools = ["//rs/css/module"],
)

diff_test(
    name = "testing_css_module_generation",
    file1 = ":basic.compiled.css",
    file2 = ":basic.output.compiled.css",
)

diff_test(
    name = "testing_json_generation",
    file1 = ":basic.output.golden.ts",
    file2 = ":basic.output.ts",
)

test_suite(
    name = "testing",
)

css_module_rule(
    name = "gen_css_modules_via_rule",
    srcs = ["basic.module.css"],
)
